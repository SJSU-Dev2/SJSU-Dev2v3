name: 'Cleanliness Check'
description: 'Runs basic cleaniness checks for SJSU-Dev2 libraries'
runs:
  using: "composite"
  steps:
    - name: ðŸ”Ž Check "${{ github.event.repository.name }}" directory
      shell: bash
      run: |
            echo "ðŸ”Ž Check "${{ github.event.repository.name }}" directory"
            test -d "${{ github.event.repository.name }}"

    - name: ðŸ“¥ Install libclang-11-dev (for name style check)
      shell: bash
      run: |
            echo
            echo "ðŸ“¥ Install libclang-11-dev (for name style check)"
            echo
            sudo apt install libclang-11-dev

    - name: ðŸ“¥ Install cpplint
      shell: bash
      run: |
            echo
            echo "ðŸ“¥ Install cpplint"
            echo
            python3 -m pip install cpplint==1.5.5

    - name: ðŸ“¥ Install pip package 'clang' & 'pyyaml' (for ncc)
      shell: bash
      run: |
            echo
            echo "ðŸ“¥ Install pip package 'clang' & 'pyyaml' (for ncc)"
            echo
            python3 -m pip install clang pyyaml

    - name: ðŸ“ƒ Check Variable Names
      shell: bash
      run: |
            echo
            echo "ðŸ“ƒ Check Variable Names"
            echo
            git clone https://github.com/nithinn/ncc.git ncc
            curl https://raw.githubusercontent.com/SJSU-Dev2/SJSU-Dev2v3/main/actions/cleanliness/.naming.style > .naming.style
            ./ncc/ncc.py --recurse \
            --path ${{ github.event.repository.name }} \
            --style .naming.style | tee ncc.stderr
            [ ! -s ncc.stderr ]

    - name: ðŸ§¹ Lint
      shell: bash
      run: |
            echo
            echo "ðŸ§¹ Lint"
            echo
            curl https://raw.githubusercontent.com/SJSU-Dev2/SJSU-Dev2v3/main/actions/cleanliness/CPPLINT.cfg > CPPLINT.cfg
            cpplint ${{ github.event.repository.name }}/*/*.cpp \
                    ${{ github.event.repository.name }}/*/*.hpp
